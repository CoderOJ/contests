<center><font size=7> 究竟(wonder) </font></center>

#### 题目描述

有时于夜幕之中，或处繁星之下，我们时常深思。我们从哪里来，我们将到哪去，我们想要走怎样的道路，我们究竟走向何方。大荒茫茫，个人的命运只是一叶扁舟，直面风浪沉浮。我们时常想要知道，“究竟”二字背后的答案。

历史总是惊人的相似。若将每个人的人生轨迹用不同的事件类型勾连，那么形式化地，每个人的人生轨迹都可以表示为一个字符集大小为$T$ 的字符串$s_i$。在预先给出了$t$ 种前人的人生轨迹$s_1 \sim s_t$的前提下，一种可能的新人的人生轨迹被称为“斑驳的”，当且仅当能表示成 $d_1 + d_2 + ... + d_t$ 。其中 $d_i$ 为 $s_i$ 的一个子串(可为空串)。而对于一些轨迹$s_l,s_{l+1},...,s_r$来说，它们的“斑驳程度” $f(l,r)$ 则是在预先给定了这些轨迹的情况下，**本质不同的**、斑驳的新人的人生轨迹的个数。

现在好奇的小Y和你谈谈心： 若他预先给定$n$位前人的人生轨迹$s_1 \sim s_n$，那么对于某些连续段，可以得出的“诗意程度”是多少。具体地，对于一个区间$l,r$, 其诗意程度就是$poem(l,r) = \sum_{i=l}^r \sum_{j=i}^r f(i,j)$。他一共会询问$q$ 次，希望你可以回答这些区间的诗意程度。



#### 输入格式

从wonder.in中读入。第一行输入一个数 $n$ 表示预先选定的人生轨迹的个数。接下来$n$行每行一个字符串$s_i$, 含义如题。再下一行是三个数$q,k1,k2$, 表示询问个数和两个输入参数；

为减少输入时间，下列$q$个询问区间将这样生成：

```c++
unsigned long long k1,k2;
unsigned long long Rand(){
	unsigned long long k3=k1, k4=k2;
	k1=k4, k3^=k3<<23, k2=k3^k4^(k3>>17)^(k4>>26);
	return k2+k4;
}

int main(){
	//读入其他东西
	//读入q,k1,k2
	for(int i=1; i<=q; i++) {
		l[i]=Rand()%n+1, r[i]=Rand()%n+1;//n含义如上
		if(l[i]>r[i]) std::swap(l[i],r[i]);
	}
}
```



#### 输出格式

输出到wonder.out。为减小输出量，请只输出一个数： 每个询问的答案   对$998244353$取模  过后得到的数  的异或和。

#### 样例输入0

```c++
4
aaa
ab
bc
cde
5 2005 0713
```



#### 样例输出0

```c++
322
```



#### 样例解释：

询问区间是[2,4] 、[2,4] 、[1,2] 、[2,3]、[1,4]，答案分别为115、115、18、20、324

其中，对于询问4，$f[2][2]=f[3][3]=4, f[2][3]=10$

对于区间[2,3],一共有 空串, a, b, c, ab, ac, bb, bc, abb, abc, bbc, abbc十个串符合要求。

（其余样例请见下发文件）

#### 数据范围

| 测试点编号 | $n \leq$ | $\sum s_i \leq$ | $q \leq$ | 特殊性质        |
| ---------- | -------- | --------------- | -------- | --------------- |
| 0~1        | \        | 20              | 10       | \               |
| 2~5        | 50000    | \               | 50000    | 保证\|$s_i$\|=1 |
| 6~8        | 2        | 400             | \        | \               |
| 9~12       | 500      | 20000           | \        | \               |
| 13~16      | \        | \               | 100000   | \               |
| 17~19      | \        | \               | \        | \               |

对于100%的数据， $T \leq 7, 0<n\leq 65000, 0<q\leq3*10^6, \sum s_i\leq 2*10^6, 0\leq k1,k2<2^{64}$

#### 限制和编译选项

2000ms  1024MB  -O2  

本题IO量较大，建议只使用cin和cout进行IO的选手用 std::ios::sync_with_stdio(0) 关闭同步.
